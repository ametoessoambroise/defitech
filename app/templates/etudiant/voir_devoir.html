{% extends "base.html" %}
{% block title %}{{ devoir.type }} : {{ devoir.titre }} | DEFITECH{% endblock %}
{% block content %}

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
  <!-- Breadcrumb / Back Button -->
  <div class="mb-6">
    <a href="{{ url_for('students.devoirs') }}"
      class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium transition-colors">
      <i class="fas fa-arrow-left mr-2"></i>
      <span>Retour à la liste</span>
    </a>
  </div>

  <!-- Main Card -->
  <div class="bg-white rounded-xl shadow-lg overflow-hidden">
    <!-- Header with gradient -->
    <div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8 sm:px-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="flex-1 min-w-0">
          <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full bg-white/20 text-white mb-3">
            {{ devoir.type|capitalize }}
          </span>
          <h1 class="text-2xl sm:text-3xl font-bold text-white break-words">{{ devoir.titre }}</h1>
        </div>
        {% if devoir.fichier %}
        <a href="/static/uploads/{{ devoir.fichier }}" target="_blank" download
          class="inline-flex items-center justify-center px-5 py-3 bg-white text-blue-600 font-semibold rounded-lg hover:bg-blue-50 active:bg-blue-100 transition-colors shadow-lg">
          <i class="fas fa-download mr-2"></i>
          <span class="hidden sm:inline">Télécharger le fichier</span>
          <span class="sm:hidden">Télécharger</span>
        </a>
        {% endif %}
      </div>
    </div>

    <!-- Content -->
    <div class="px-6 py-8 sm:px-8">
      <!-- Description Section -->
      <div class="mb-8">
        <h2 class="text-lg font-semibold text-gray-900 mb-3 flex items-center">
          <i class="fas fa-align-left text-blue-600 mr-2"></i>
          Description
        </h2>
        <div class="bg-gray-50 rounded-lg p-4 sm:p-6">
          <p class="text-gray-700 leading-relaxed whitespace-pre-line break-words">{{ devoir.description }}</p>
        </div>
      </div>

      <!-- Information Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8">
        <!-- Filière & Année -->
        <div class="bg-blue-50 rounded-lg p-4 border border-blue-100">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
              <i class="fas fa-graduation-cap text-white"></i>
            </div>
            <div class="ml-4 flex-1 min-w-0">
              <p class="text-xs font-medium text-blue-600 uppercase tracking-wide mb-1">Formation</p>
              <p class="text-base font-semibold text-gray-900 break-words">{{ devoir.filiere }}</p>
              <p class="text-sm text-gray-600 mt-1">Année {{ devoir.annee }}</p>
            </div>
          </div>
        </div>

        <!-- Enseignant -->
        <div class="bg-purple-50 rounded-lg p-4 border border-purple-100">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center">
              <i class="fas fa-user-tie text-white"></i>
            </div>
            <div class="ml-4 flex-1 min-w-0">
              <p class="text-xs font-medium text-purple-600 uppercase tracking-wide mb-1">Enseignant</p>
              <p class="text-base font-semibold text-gray-900 break-words">
                {{ devoir.enseignant.user.nom }} {{ devoir.enseignant.user.prenom }}
              </p>
            </div>
          </div>
        </div>

        <!-- Date limite -->
        <div class="bg-red-50 rounded-lg p-4 border border-red-100">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-10 h-10 bg-red-600 rounded-lg flex items-center justify-center">
              <i class="fas fa-calendar-times text-white"></i>
            </div>
            <div class="ml-4 flex-1 min-w-0">
              <p class="text-xs font-medium text-red-600 uppercase tracking-wide mb-1">Date limite</p>
              <p class="text-base font-semibold text-gray-900">
                {{ devoir.date_limite.strftime('%d/%m/%Y') if devoir.date_limite else 'Aucune limite' }}
              </p>
              {% if devoir.date_limite %}
              <p class="text-sm text-gray-600 mt-1">
                {{ devoir.date_limite.strftime('%A %d %B %Y') if devoir.date_limite else '' }}
              </p>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Date d'envoi -->
        <div class="bg-green-50 rounded-lg p-4 border border-green-100">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center">
              <i class="fas fa-paper-plane text-white"></i>
            </div>
            <div class="ml-4 flex-1 min-w-0">
              <p class="text-xs font-medium text-green-600 uppercase tracking-wide mb-1">Date d'envoi</p>
              <p class="text-base font-semibold text-gray-900">
                {{ devoir.date_creation.strftime('%d/%m/%Y') }}
              </p>
              <p class="text-sm text-gray-600 mt-1">
                {{ devoir.date_creation.strftime('%H:%M') }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- File Download Section (if exists) -->
      {% if devoir.fichier %}
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">
              <i class="fas fa-file-alt text-white text-xl"></i>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-600 mb-1">Fichier joint</p>
              <p class="text-base font-semibold text-gray-900 break-all">{{ devoir.fichier }}</p>
            </div>
          </div>
          <a href="/static/uploads/{{ devoir.fichier }}" target="_blank" download
            class="inline-flex items-center justify-center px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-colors shadow-md flex-shrink-0">
            <i class="fas fa-download mr-2"></i>Télécharger
          </a>
        </div>
      </div>
      {% endif %}

      <!-- Action Buttons -->
      <div class="mt-8 pt-6 border-t border-gray-200">
        <div class="flex flex-col sm:flex-row gap-3">
          <a href="{{ url_for('students.devoirs') }}"
            class="flex-1 inline-flex items-center justify-center px-6 py-3 bg-gray-100 text-gray-700 font-medium rounded-lg hover:bg-gray-200 active:bg-gray-300 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i>Retour à la liste
          </a>
          {% if devoir.fichier %}
          <a href="/static/uploads/{{ devoir.fichier }}" target="_blank" download
            class="flex-1 inline-flex items-center justify-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-colors">
            <i class="fas fa-download mr-2"></i>Télécharger le fichier
          </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}