{% extends "admin/base.html" %} {% block title %}Gestion des étudiants | DEFITECH{% endblock %} {% block content %}

<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <h1 class="text-2xl font-bold mb-6">Liste des étudiants</h1>

    <!-- Formulaire de filtres -->
    <form method="get" class="mb-6 bg-white rounded shadow p-4 flex flex-wrap gap-4 items-end">
        <div>
            <label for="id" class="block text-xs font-semibold text-gray-700 mb-1">ID</label>
            <input type="text" id="id" name="id" value="{{ id_filter }}" class="px-2 py-1 border rounded w-28"
                placeholder="ID">
        </div>
        <div>
            <label for="nom" class="block text-xs font-semibold text-gray-700 mb-1">Nom</label>
            <input type="text" id="nom" name="nom" value="{{ nom_filter }}" class="px-2 py-1 border rounded w-32"
                placeholder="Nom">
        </div>
        <div>
            <label for="prenom" class="block text-xs font-semibold text-gray-700 mb-1">Prénom</label>
            <input type="text" id="prenom" name="prenom" value="{{ prenom_filter }}"
                class="px-2 py-1 border rounded w-32" placeholder="Prénom">
        </div>
        <div>
            <label for="email" class="block text-xs font-semibold text-gray-700 mb-1">Email</label>
            <input type="text" id="email" name="email" value="{{ email_filter }}" class="px-2 py-1 border rounded w-40"
                placeholder="Email">
        </div>
        <div>
            <label for="filiere" class="block text-xs font-semibold text-gray-700 mb-1">Filière</label>
            <select id="filiere" name="filiere" class="px-2 py-1 border rounded w-40">
                <option value="">Toutes</option>
                {% for f in filieres %}
                <option value="{{ f.nom }}" {% if filiere_filter==f.nom %}selected{% endif %}>{{ f.nom }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label for="annee" class="block text-xs font-semibold text-gray-700 mb-1">Année</label>
            <select id="annee" name="annee" class="px-2 py-1 border rounded w-32">
                <option value="">Toutes</option>
                {% for a in annees %}
                <option value="{{ a.nom }}" {% if annee_filter==a.nom %}selected{% endif %}>{{ a.nom }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="flex items-end h-full">
            <button type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded ml-2 text-xs">Filtrer</button>
            <a href="{{ url_for('admin.admin_etudiants') }}"
                class="ml-2 text-white bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-xs">Réinitialiser</a>
        </div>
    </form>

    <table class="min-w-full divide-y divide-gray-200 text-xs sm:text-sm bg-white rounded shadow">
        <thead class="bg-blue-600">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-semibold text-white uppercase tracking-wider">Nom</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-white uppercase tracking-wider">Prénom</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-white uppercase tracking-wider">Email</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-white uppercase tracking-wider">Filière</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-white uppercase tracking-wider">Année</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-white uppercase tracking-wider">Statut</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-100">
            {% for user, info in etudiants_data %}
            <tr class="hover:bg-blue-50 transition">
                <td class="px-4 py-2">{{ user.nom }}</td>
                <td class="px-4 py-2">{{ user.prenom }}</td>
                <td class="px-4 py-2">{{ user.email }}</td>
                <td class="px-4 py-2">{{ info.filiere if info else '-' }}</td>
                <td class="px-4 py-2">{{ info.annee if info else '-' }}</td>
                <td class="px-4 py-2">{{ user.statut }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}